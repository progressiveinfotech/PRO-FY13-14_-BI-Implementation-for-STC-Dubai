TRUNCATE TABLE STC_FACT_WMS_POSITION;
COMMIT;
INSERT INTO STCBI106.STC_FACT_WMS_POSITION
( ARTICLE_ID
, CATEGORY_ID
, CAT_MANG_ID
, COMP_ID
, BRAND_ID
, FOOD_CAT_ID
, GRADE1_ID
, GRADE2_ID
, WH_ID
, SIZE_ID
, LOCATION_ID
, PACKING_ID
, ITEM_UOM_ID
, ITEM_ID
, PALLET_POSITION_ID
, PS_WH_CODE
, PS_PALLET_POSN_NO
, PS_DIMENSION_UOM_CODE
, PS_USABLE_LENGTH
, PS_USABLE_BREADTH
, PS_USABLE_HEIGHT
, PS_USABLE_VOLUME
, PS_UTILISED_VOLUME
, PS_POS_TOL_HEIGHT
, PS_NEG_TOL_HEIGHT
, PS_POS_TOL_VOLUME
, PS_NEG_TOL_VOLUME
, PS_WEIGHT_UOM_CODE
, PS_USABLE_WEIGHT
, PS_UTILISED_WEIGHT
, PS_TOL_WEIGHT
, PS_MIN_PALLET_VOLUME
, PS_CR_UID
, PS_CR_DT
, PS_UPD_UID
, PS_UPD_DT
, PS_SYS_ID
, PS_STATUS
, PS_NO_OF_ITEMS_LOCKED
, PS_POSN_FRZ_FLAG_NUM
, PS_HOLD_WEIGHT
, PS_HOLD_VOLUME
, PS_ISSD_WEIGHT
, PS_ISSD_VOLUME
, PS_RCVD_WEIGHT
, PS_RCVD_VOLUME
, PS_ACT_ITEM_CNT
, PS_ACT_PALLET_CNT
, PS_LAST_CYL_COUNT_DATE
, PS_EMPTY_STATUS
, PSI_SYS_ID
, PSI_PS_SYS_ID
, PSI_COMP_CODE
, PSI_WH_CODE
, PSI_PALLET_NO
, PSI_PALLET_SYS_ID
, PSI_LOCN_CODE
, PSI_ITEM_CODE
, PSI_PACK_CODE
, PSI_WEIGHT_UOM_CODE
, PSI_RCVD_DT
, PSI_STK_QTY_BU
, PSI_MAX_QTY_BU
, PSI_RCVD_QTY_BU
, PSI_ISSD_QTY_BU
, PSI_LENGTH
, PSI_WIDTH
, PSI_HEIGHT
, PSI_WEIGHT
, PSI_VOLUME
, PSI_DIMENSION_UOM
, PSI_GRADE_CODE_1
, PSI_GRADE_CODE_2
, PSI_HOLD_QTY_BU
, PSI_RCVD_QTY_BU_1
, PSI_RCVD_QTY_BU_2
, PSI_RCVD_QTY_BU_3
, PSI_RCVD_QTY_BU_4
, PSI_RCVD_QTY_BU_5
, PSI_ISSD_QTY_BU_1
, PSI_ISSD_QTY_BU_2
, PSI_ISSD_QTY_BU_3
, PSI_ISSD_QTY_BU_4
, PSI_ISSD_QTY_BU_5
, PSI_REJECT_QTY_BU
, PSI_RESV_QTY_BU
, PSI_CR_DT
, PSI_CR_UID
, PSI_UPD_DT
, PSI_UPD_UID
, PSI_PUW_HOLD_QTY_BU
, PSI_POSN_NO
, PSI_LOCK_FLAG_YN_NUM
, PSI_LOCK_DATE
, PSI_REJECT_RESV_QTY_BU
, PSI_LOCK_TYPE
, prog_cbm
, prog_cbm_BU
, prog_ITEM_AREA 
,IP_PACK_LENGTH
,IP_PACK_WIDTH
,IP_PACK_HEIGHT
,IP_DIMENSION_UOM_CODE
,IP_PACK_WEIGHT
,IP_WEIGHT_UOM_CODE,
IM_MANF_NAME,
PROG_CR_DT
)
SELECT
STC_DIM_ARTICLE.ARTICLE_ID
, STC_DIM_CATEGORY.CATEGORY_ID
, STC_DIM_CAT_MANG.CAT_MANG_ID
, STC_DIM_COMPANIES.COMP_ID
, STC_DIM_DEPARTMENT.DEPARTMENT_ID
, STC_DIM_FOOD_CAT.FOOD_CAT_ID
, STC_DIM_GRADE1.GRADE1_ID
, STC_DIM_GRADE2.GRADE2_ID
, STC_DIM_WMS_WH.WH_ID
, STC_DIM_SIZE.SIZE_ID
, STC_DIM_LOCATION.LOCATION_ID
, STC_DIM_PACKING.PACKING_ID
, STC_DIM_ITEM_UOM.ITEM_UOM_ID
, STC_DIM_ITEM.ITEM_ID
, STC_DIM_WMS_PALLET_POSITION.PALLET_POSITION_ID
, A.PS_WH_CODE
, A.PS_PALLET_POSN_NO
, A.PS_DIMENSION_UOM_CODE
, A.PS_USABLE_LENGTH
, A.PS_USABLE_BREADTH
, A.PS_USABLE_HEIGHT
, A.PS_USABLE_VOLUME
, A.PS_UTILISED_VOLUME
, A.PS_POS_TOL_HEIGHT
, A.PS_NEG_TOL_HEIGHT
, A.PS_POS_TOL_VOLUME
, A.PS_NEG_TOL_VOLUME
, A.PS_WEIGHT_UOM_CODE
, A.PS_USABLE_WEIGHT
, A.PS_UTILISED_WEIGHT
, A.PS_TOL_WEIGHT
, A.PS_MIN_PALLET_VOLUME
, A.PS_CR_UID
, A.PS_CR_DT
, A.PS_UPD_UID
, A.PS_UPD_DT
, A.PS_SYS_ID
, A.PS_STATUS
, A.PS_NO_OF_ITEMS_LOCKED
, A.PS_POSN_FRZ_FLAG_NUM
, A.PS_HOLD_WEIGHT
, A.PS_HOLD_VOLUME
, A.PS_ISSD_WEIGHT
, A.PS_ISSD_VOLUME
, A.PS_RCVD_WEIGHT
, A.PS_RCVD_VOLUME
, A.PS_ACT_ITEM_CNT
, A.PS_ACT_PALLET_CNT
, A.PS_LAST_CYL_COUNT_DATE
, A.PS_EMPTY_STATUS
, B.PSI_SYS_ID
, B.PSI_PS_SYS_ID
, B.PSI_COMP_CODE
, B.PSI_WH_CODE
, B.PSI_PALLET_NO
, B.PSI_PALLET_SYS_ID
, B.PSI_LOCN_CODE
, B.PSI_ITEM_CODE
, B.PSI_PACK_CODE
, B.PSI_WEIGHT_UOM_CODE
, B.PSI_RCVD_DT
, B.PSI_STK_QTY_BU
, B.PSI_MAX_QTY_BU
, B.PSI_RCVD_QTY_BU
, B.PSI_ISSD_QTY_BU
, B.PSI_LENGTH
, B.PSI_WIDTH
, B.PSI_HEIGHT
, B.PSI_WEIGHT
, B.PSI_VOLUME
, B.PSI_DIMENSION_UOM
, B.PSI_GRADE_CODE_1
, B.PSI_GRADE_CODE_2
, B.PSI_HOLD_QTY_BU
, B.PSI_RCVD_QTY_BU_1
, B.PSI_RCVD_QTY_BU_2
, B.PSI_RCVD_QTY_BU_3
, B.PSI_RCVD_QTY_BU_4
, B.PSI_RCVD_QTY_BU_5
, B.PSI_ISSD_QTY_BU_1
, B.PSI_ISSD_QTY_BU_2
, B.PSI_ISSD_QTY_BU_3
, B.PSI_ISSD_QTY_BU_4
, B.PSI_ISSD_QTY_BU_5
, B.PSI_REJECT_QTY_BU
, B.PSI_RESV_QTY_BU
, B.PSI_CR_DT
, B.PSI_CR_UID
, B.PSI_UPD_DT
, B.PSI_UPD_UID
, B.PSI_PUW_HOLD_QTY_BU
, B.PSI_POSN_NO
, B.PSI_LOCK_FLAG_YN_NUM
, B.PSI_LOCK_DATE
, B.PSI_REJECT_RESV_QTY_BU
, B.PSI_LOCK_TYPE
,(C.IP_PACK_LENGTH * C.IP_PACK_WIDTH * C.IP_PACK_HEIGHT)/1000000 AS prog_cbm
,(C.IP_PACK_LENGTH * C.IP_PACK_WIDTH * C.IP_PACK_HEIGHT * C.IP_MAX_QTY_BU)/1000000 AS prog_cbm_BU
,(C.IP_PACK_LENGTH * C.IP_PACK_WIDTH)/10000 AS prog_ITEM_AREA 
,C.IP_PACK_LENGTH
,C.IP_PACK_WIDTH
,C.IP_PACK_HEIGHT
,c.IP_DIMENSION_UOM_CODE
,c.IP_PACK_WEIGHT
,c.IP_WEIGHT_UOM_CODE,
D.IM_MANF_NAME,
sysdate
FROM 
OS_POSITION@stcbi A,
OS_POSITION_ITEM@stcbi B
left outer join STCBI106.STC_DIM_LOCATION STC_DIM_LOCATION
on (B.PSI_LOCN_CODE = STC_DIM_LOCATION.LOCN_CODE)
left outer join STCBI106.STC_DIM_WMS_WH STC_DIM_WMS_WH
on (STC_DIM_WMS_WH.WH_CODE=B.PSI_WH_CODE)
left outer join STCBI106.STC_DIM_WMS_PALLET_POSITION STC_DIM_WMS_PALLET_POSITION
on (B.PSI_POSN_NO = STC_DIM_WMS_PALLET_POSITION.PP_PALLET_POSN_NO)
left outer join STCBI106.stc_dim_companies stc_dim_companies
on (stc_diM_companies.company_code=B.PSI_COMP_CODE)
left outer join   STCBI106.STC_DIM_GRADE1 STC_DIM_GRADE1 on 
(b.PSI_GRADE_CODE_1 = STC_DIM_GRADE1.GRADE_CODE)
left outer join   STCBI106.STC_DIM_GRADE2 STC_DIM_GRADE2 on 
(b.PSI_GRADE_CODE_2 = STC_DIM_GRADE2.GRADE_CODE)
left outer join STCBI106.STC_DIM_ITEM STC_DIM_ITEM
on (B.PSI_item_CODE = STC_DIM_ITEM.item_CODE)
left outer join STCBI106.STC_DIM_ITEM_UOM STC_DIM_ITEM_UOM
on (B.PSI_item_CODE = STC_DIM_ITEM_UOM.iu_item_CODE AND
B.PSI_PACK_CODE = STC_DIM_ITEM_UOM.IU_UOM_CODE)
left outer join OM_ITEM_PACK@stcbi C
on (B.PSI_ITEM_CODE= C.IP_ITEM_CODE and B.PSI_PACK_CODE = C.IP_PACK_UOM_CODE)
left outer join OM_ITEM_MANF@stcbi D  
on (B.PSI_ITEM_CODE= D.IM_ITEM_CODE AND B.PSI_PACK_CODE = D.IM_MANF_PART_NO),
OM_ITEM@stcbi E
left outer join   STCBI106.STC_DIM_DEPARTMENT STC_DIM_DEPARTMENT ON 
(E.ITEM_ANLY_CODE_02 = STC_DIM_DEPARTMENT.DEPARTMENT_CODE AND 
E.ITEM_ANLY_CODE_06 = STC_DIM_DEPARTMENT.CLASS_CODE AND
E.ITEM_ANLY_CODE_07 = STC_DIM_DEPARTMENT.SUB_CLASS_CODE)
left outer join   STCBI106.STC_DIM_CATEGORY STC_DIM_CATEGORY ON
(E.ITEM_ANLY_CODE_08 = STC_DIM_CATEGORY.CATEGORY_CODE)
left outer join   STCBI106.STC_DIM_SIZE STC_DIM_SIZE ON
(E.ITEM_ANLY_CODE_12 = STC_DIM_SIZE.SIZE_CODE)
left outer join   STCBI106.STC_DIM_CAT_MANG STC_DIM_CAT_MANG ON
(E.ITEM_ANLY_CODE_13 = STC_DIM_CAT_MANG.CAT_MANG_CODE)
left outer join   STCBI106.STC_DIM_FOOD_CAT STC_DIM_FOOD_CAT ON
(E.ITEM_ANLY_CODE_03 = STC_DIM_FOOD_CAT.FOOD_CAT_CODE AND
E.ITEM_ANLY_CODE_04 = STC_DIM_FOOD_CAT.FOOD_SUB_CAT_CODE)
left outer join   STCBI106.STC_DIM_PACKING STC_DIM_PACKING ON
(E.ITEM_ANLY_CODE_11 = STC_DIM_PACKING.PACKING_CODE)
left outer join   STCBI106.STC_DIM_ARTICLE STC_DIM_ARTICLE ON 
(E.ITEM_ANLY_CODE_10 = STC_DIM_ARTICLE.ARTICLE_CODE)
WHERE 
A.PS_SYS_ID = B.PSI_PS_SYS_ID AND
B.PSI_ITEM_CODE = E.ITEM_CODE AND
to_date(A.PS_CR_DT,'DD-MM-YYYY')>=TO_DATE('1-Jul-09','DD-MM-YYYY') 
and to_date(A.PS_CR_DT,'DD-MM-YYYY')<TO_DATE(sysdate,'DD-MM-YYYY');
commit;