TRUNCATE TABLE STCBI106.STC_FACT_WMS_WAVE;
COMMIT;
INSERT INTO STCBI106.STC_FACT_WMS_WAVE
(
  WMS_RULE_ID
, ARTICLE_ID
, CATEGORY_ID
, CAT_MANG_ID
, COMPANY_ID
, CUSTOMER_ID
, BRAND_ID
, FOOD_CAT_ID
, GRADE1_ID
, GRADE2_ID
, WH_ID_1
, TRAN_ID
, SIZE_ID
, REF_TXN_ID
, LOCATION_ID
, PACKING_ID
, ITEM_UOM_ID
, ITEM_ID
, WWH_SYS_ID
, WWH_COMP_CODE
, WWH_TXN_CODE
, WWH_NO
, WWH_DOC_SRC_LOCN_CODE
, WWH_BATCH_SEQ_NO
, WWH_DT
, WWH_TXN_ID
, WWH_REF_INTOH_SYS_ID
, WWH_REF_TXN_TYPE
, WWH_HOST_CATG_TYPE
, WWH_HOST_TXN_ID
, WWH_REF_SYS_ID
, WWH_ACNT_YEAR
, WWH_REF_FROM_NUM
, WWH_REF_TXN_CODE
, WWH_REF_NO
, WWH_REF_DT
, WWH_CAL_YEAR
, WWH_CAL_PERIOD
, WWH_ANNOTATION
, WWH_LOCN_CODE
, WWH_WH_CODE
, WWH_CUST_CODE
, WWH_CUST_NAME
, WWH_CUST_REF
, WWH_SHIP_TO_ADDR_CODE
, WWH_ORDER_TYPE
, WWH_SHIP_AGENT
, WWH_SHIP_REF_NO
, WWH_AWB_BILL_NO
, WWH_VOYAGE_NO
, WWH_CARRIER_CODE
, WWH_VESSEL_CODE
, WWH_SHIP_MODE
, WWH_SHIP_LINE
, WWH_SHIP_DT
, WWH_STATUS
, WWH_ORDER_PRIORITY
, WWH_CHARGE_AREA
, WWH_CHARGE_AREA_NUM
, WWH_CHARGE_CODE
, WWH_ALLOC_SELECT_YN_NUM
, WWH_REL_SELECT_YN_NUM
, WWH_PACK_DT
, WWH_APPR_STATUS
, WWH_APPR_UID
, WWH_APPR_DT
, WWH_SUBMIT_STATUS
, WWH_PRINT_STATUS
, WWH_WAVE_TYPE
, WWH_DESTINATION
, WWH_FLEX_01
, WWH_FLEX_02
, WWH_FLEX_03
, WWH_FLEX_04
, WWH_FLEX_05
, WWH_FLEX_06
, WWH_FLEX_07
, WWH_FLEX_08
, WWH_FLEX_09
, WWH_FLEX_10
, WWH_FLEX_11
, WWH_FLEX_12
, WWH_FLEX_13
, WWH_FLEX_14
, WWH_FLEX_15
, WWH_FLEX_16
, WWH_FLEX_17
, WWH_FLEX_18
, WWH_FLEX_19
, WWH_FLEX_20
, WWH_CR_DT
, WWH_CR_UID
, WWH_UPD_DT
, WWH_UPD_UID
, WWH_PULLQTYBASE
, WWH_PULLINVQTY
, WWH_PIGEON_HOLE_ALLOC_YN
, WWH_PGH_ALLOC_STRATERGY
, WWH_PGH_CONSOL_AREA
, WWH_PGH_ITEM_SEGREG_YN
, WWH_PGH_ITEM_FILTER_CODE
, WWH_AUTO_GEN_ISS_YN
, WWH_RESV_ISS_NO_YN
, WWH_AUTO_APPR_ISS_YN
, WWH_HHD_APPR_ISS_YN
, WWH_ISS_DATE
, WWH_AUSTSZEOSTK
, WWH_AUTO_GEN_RCV_YN
, WWI_SYS_ID
, WWI_WWH_SYS_ID
, WWI_INTOI_SYS_ID
, WWI_WAVE_ID
, WWI_CUST_CODE
, WWI_WWH_TXN_CODE
, WWI_WWH_NO
, WWI_WWH_DT
, WWI_INTOH_SYS_ID
, WWI_INTOH_REF_SYS_ID
, WWI_REF_TXN_CODE
, WWI_REF_NO
, WWI_ITEM_BAR_CODE
, WWI_ITEM_CODE
, WWI_ITEM_DESC
, WWI_ITEM_REMARKS
, WWI_GRADE_CODE_1
, WWI_GRADE_CODE_2
, WWI_UOM_CODE
, WWI_ITEM_LENGTH
, WWI_ITEM_WIDTH
, WWI_ITEM_HEIGHT
, WWI_ITEM_AREA
, WWI_ITEM_WEIGHT
, WWI_DIMENSION_UOM
, WWI_ITEM_VOLUME
, WWI_QTY
, WWI_QTY_LS
, WWI_QTY_BU
, WWI_ALLOC_SELECT_YN_NUM
, WWI_ALLOC_QTY
, WWI_ALLOC_QTY_LS
, WWI_ALLOC_QTY_BU
, WWI_CUM_ALLOC_QTY_BU
, WWI_CUM_PICK_QTY_BU
, WWI_CUM_PACK_QTY_BU
, WWI_RESV_QTY_BU
, WWI_PEND_ALLOC_QTY_BU
, WWI_REL_SELECT_YN_NUM
, WWI_HELD_FOR_REP_YN_NUM
, WWI_STATUS
, WWI_RULE_CODE
, WWI_PICKER_CODE
, WWI_REL_DT
, WWI_WOH_SYS_ID
, WWI_WOH_TXN_CODE
, WWI_WOH_NO
, WWI_WOH_DT
, WWI_FLEX_01
, WWI_FLEX_02
, WWI_FLEX_03
, WWI_FLEX_04
, WWI_FLEX_05
, WWI_FLEX_06
, WWI_FLEX_07
, WWI_FLEX_08
, WWI_FLEX_09
, WWI_FLEX_10
, WWI_FLEX_11
, WWI_FLEX_12
, WWI_FLEX_13
, WWI_FLEX_14
, WWI_FLEX_15
, WWI_FLEX_16
, WWI_FLEX_17
, WWI_FLEX_18
, WWI_FLEX_19
, WWI_FLEX_20
, WWI_CR_UID
, WWI_CR_DT
, WWI_UPD_UID
, WWI_UPD_DT
, WWI_CRITERIA_CODE
, WWI_INVI_QTY_BU
, WWI_DNI_QTY_BU
, WWI_LTO_QTY_BU
, WWI_MI_QTY_BU
, WWI_SURTN_QTY_BU
, WWI_BO_WAVED_QTY_BU
, WWI_ACT_QTY
, WWI_ACT_QTY_LS
, WWI_ACT_QTY_BU
, WWI_RULE_TYPE
, WWI_SHIP_TO_ADDR_CODE
, WWI_BACKORDER_YN
, WWI_LTI_CR_YN_NUM
, WWI_DISPATCH_STATUS
, WWI_REASON_CODE
, WWI_VERF_QTY_BU
, WWI_REJ_QTY_BU
,prog_cbm
,prog_cbm_BU
,prog_ITEM_AREA 
,IP_PACK_LENGTH
,IP_PACK_WIDTH
,IP_PACK_HEIGHT
,IP_DIMENSION_UOM_CODE
,IP_PACK_WEIGHT
,IP_WEIGHT_UOM_CODE,
IM_MANF_NAME,
PROG_CR_DT
)
SELECT
STC_DIM_WMS_RULE.WMS_RULE_ID
, STC_DIM_ARTICLE.ARTICLE_ID
, STC_DIM_CATEGORY.CATEGORY_ID
, STC_DIM_CAT_MANG.CAT_MANG_ID
, STC_DIM_COMPANIES.COMP_ID
, STC_DIM_CUSTOMER.CUSTOMER_ID
, STC_DIM_DEPARTMENT.DEPARTMENT_ID
, STC_DIM_FOOD_CAT.FOOD_CAT_ID
, STC_DIM_GRADE1.GRADE1_ID
, STC_DIM_GRADE2.GRADE2_ID
, STC_DIM_WMS_WH.WH_ID
, STC_DIM_TXN.TXN_ID
, STC_DIM_SIZE.SIZE_ID
, STC_DIM_REF_TXN.TXN_ID
, STC_DIM_LOCATION.LOCATION_ID
, STC_DIM_PACKING.PACKING_ID
, STC_DIM_ITEM_UOM.ITEM_UOM_ID
, STC_DIM_ITEM.ITEM_ID
, B.WWH_SYS_ID
, B.WWH_COMP_CODE
, B.WWH_TXN_CODE
, B.WWH_NO
, B.WWH_DOC_SRC_LOCN_CODE
, B.WWH_BATCH_SEQ_NO
, B.WWH_DT
, B.WWH_TXN_ID
, B.WWH_REF_INTOH_SYS_ID
, B.WWH_REF_TXN_TYPE
, B.WWH_HOST_CATG_TYPE
, B.WWH_HOST_TXN_ID
, B.WWH_REF_SYS_ID
, B.WWH_ACNT_YEAR
, B.WWH_REF_FROM_NUM
, B.WWH_REF_TXN_CODE
, B.WWH_REF_NO
, B.WWH_REF_DT
, B.WWH_CAL_YEAR
, B.WWH_CAL_PERIOD
, B.WWH_ANNOTATION
, B.WWH_LOCN_CODE
, B.WWH_WH_CODE
, B.WWH_CUST_CODE
, B.WWH_CUST_NAME
, B.WWH_CUST_REF
, B.WWH_SHIP_TO_ADDR_CODE
, B.WWH_ORDER_TYPE
, B.WWH_SHIP_AGENT
, B.WWH_SHIP_REF_NO
, B.WWH_AWB_BILL_NO
, B.WWH_VOYAGE_NO
, B.WWH_CARRIER_CODE
, B.WWH_VESSEL_CODE
, B.WWH_SHIP_MODE
, B.WWH_SHIP_LINE
, B.WWH_SHIP_DT
, B.WWH_STATUS
, B.WWH_ORDER_PRIORITY
, B.WWH_CHARGE_AREA
, B.WWH_CHARGE_AREA_NUM
, B.WWH_CHARGE_CODE
, B.WWH_ALLOC_SELECT_YN_NUM
, B.WWH_REL_SELECT_YN_NUM
, B.WWH_PACK_DT
, B.WWH_APPR_STATUS
, B.WWH_APPR_UID
, B.WWH_APPR_DT
, B.WWH_SUBMIT_STATUS
, B.WWH_PRINT_STATUS
, B.WWH_WAVE_TYPE
, B.WWH_DESTINATION
, B.WWH_FLEX_01
, B.WWH_FLEX_02
, B.WWH_FLEX_03
, B.WWH_FLEX_04
, B.WWH_FLEX_05
, B.WWH_FLEX_06
, B.WWH_FLEX_07
, B.WWH_FLEX_08
, B.WWH_FLEX_09
, B.WWH_FLEX_10
, B.WWH_FLEX_11
, B.WWH_FLEX_12
, B.WWH_FLEX_13
, B.WWH_FLEX_14
, B.WWH_FLEX_15
, B.WWH_FLEX_16
, B.WWH_FLEX_17
, B.WWH_FLEX_18
, B.WWH_FLEX_19
, B.WWH_FLEX_20
, B.WWH_CR_DT
, B.WWH_CR_UID
, B.WWH_UPD_DT
, B.WWH_UPD_UID
, B.WWH_PULLQTYBASE
, B.WWH_PULLINVQTY
, B.WWH_PIGEON_HOLE_ALLOC_YN
, B.WWH_PGH_ALLOC_STRATERGY
, B.WWH_PGH_CONSOL_AREA
, B.WWH_PGH_ITEM_SEGREG_YN
, B.WWH_PGH_ITEM_FILTER_CODE
, B.WWH_AUTO_GEN_ISS_YN
, B.WWH_RESV_ISS_NO_YN
, B.WWH_AUTO_APPR_ISS_YN
, B.WWH_HHD_APPR_ISS_YN
, B.WWH_ISS_DATE
, B.WWH_AUSTSZEOSTK
, B.WWH_AUTO_GEN_RCV_YN
, A.WWI_SYS_ID
, A.WWI_WWH_SYS_ID
, A.WWI_INTOI_SYS_ID
, A.WWI_WAVE_ID
, A.WWI_CUST_CODE
, A.WWI_WWH_TXN_CODE
, A.WWI_WWH_NO
, A.WWI_WWH_DT
, A.WWI_INTOH_SYS_ID
, A.WWI_INTOH_REF_SYS_ID
, A.WWI_REF_TXN_CODE
, A.WWI_REF_NO
, A.WWI_ITEM_BAR_CODE
, A.WWI_ITEM_CODE
, A.WWI_ITEM_DESC
, A.WWI_ITEM_REMARKS
, A.WWI_GRADE_CODE_1
, A.WWI_GRADE_CODE_2
, A.WWI_UOM_CODE
, A.WWI_ITEM_LENGTH
, A.WWI_ITEM_WIDTH
, A.WWI_ITEM_HEIGHT
, A.WWI_ITEM_AREA
, A.WWI_ITEM_WEIGHT
, A.WWI_DIMENSION_UOM
, A.WWI_ITEM_VOLUME
, A.WWI_QTY
, A.WWI_QTY_LS
, A.WWI_QTY_BU
, A.WWI_ALLOC_SELECT_YN_NUM
, A.WWI_ALLOC_QTY
, A.WWI_ALLOC_QTY_LS
, A.WWI_ALLOC_QTY_BU
, A.WWI_CUM_ALLOC_QTY_BU
, A.WWI_CUM_PICK_QTY_BU
, A.WWI_CUM_PACK_QTY_BU
, A.WWI_RESV_QTY_BU
, A.WWI_PEND_ALLOC_QTY_BU
, A.WWI_REL_SELECT_YN_NUM
, A.WWI_HELD_FOR_REP_YN_NUM
, A.WWI_STATUS
, A.WWI_RULE_CODE
, A.WWI_PICKER_CODE
, A.WWI_REL_DT
, A.WWI_WOH_SYS_ID
, A.WWI_WOH_TXN_CODE
, A.WWI_WOH_NO
, A.WWI_WOH_DT
, A.WWI_FLEX_01
, A.WWI_FLEX_02
, A.WWI_FLEX_03
, A.WWI_FLEX_04
, A.WWI_FLEX_05
, A.WWI_FLEX_06
, A.WWI_FLEX_07
, A.WWI_FLEX_08
, A.WWI_FLEX_09
, A.WWI_FLEX_10
, A.WWI_FLEX_11
, A.WWI_FLEX_12
, A.WWI_FLEX_13
, A.WWI_FLEX_14
, A.WWI_FLEX_15
, A.WWI_FLEX_16
, A.WWI_FLEX_17
, A.WWI_FLEX_18
, A.WWI_FLEX_19
, A.WWI_FLEX_20
, A.WWI_CR_UID
, A.WWI_CR_DT
, A.WWI_UPD_UID
, A.WWI_UPD_DT
, A.WWI_CRITERIA_CODE
, A.WWI_INVI_QTY_BU
, A.WWI_DNI_QTY_BU
, A.WWI_LTO_QTY_BU
, A.WWI_MI_QTY_BU
, A.WWI_SURTN_QTY_BU
, A.WWI_BO_WAVED_QTY_BU
, A.WWI_ACT_QTY
, A.WWI_ACT_QTY_LS
, A.WWI_ACT_QTY_BU
, A.WWI_RULE_TYPE
, A.WWI_SHIP_TO_ADDR_CODE
, A.WWI_BACKORDER_YN
, A.WWI_LTI_CR_YN_NUM
, A.WWI_DISPATCH_STATUS
, A.WWI_REASON_CODE
, A.WWI_VERF_QTY_BU
, A.WWI_REJ_QTY_BU
,(C.IP_PACK_LENGTH * C.IP_PACK_WIDTH * C.IP_PACK_HEIGHT)/1000000 AS prog_cbm
,(C.IP_PACK_LENGTH * C.IP_PACK_WIDTH * C.IP_PACK_HEIGHT * C.IP_MAX_QTY_BU)/1000000 AS prog_cbm_BU
,(C.IP_PACK_LENGTH * C.IP_PACK_WIDTH)/10000 AS prog_ITEM_AREA 
,C.IP_PACK_LENGTH
,C.IP_PACK_WIDTH
,C.IP_PACK_HEIGHT
,c.IP_DIMENSION_UOM_CODE
,c.IP_PACK_WEIGHT
,c.IP_WEIGHT_UOM_CODE,
D.IM_MANF_NAME,
sysdate
FROM 
OT_WMS_WAVE_HEAD@STCBI B
left outer join STCBI106.stc_dim_companies stc_dim_companies
on (stc_diM_companies.company_code=B.WWH_COMP_CODE)
left outer join STCBI106.STC_DIM_LOCATION STC_DIM_LOCATION
on (B.WWH_LOCN_CODE = STC_DIM_LOCATION.LOCN_CODE)
left outer join STCBI106.STC_DIM_WMS_WH STC_DIM_WMS_WH
on (STC_DIM_WMS_WH.WH_CODE=B.WWH_WH_CODE)
left outer join STCBI106.STC_DIM_TXN STC_DIM_TXN
on (STC_DIM_TXN.TXN_CODE=B.WWH_TXN_CODE)
left outer join STCBI106.STC_DIM_CUSTOMER STC_DIM_CUSTOMER
on (B.WWH_CUST_CODE = STC_DIM_CUSTOMER.CUST_CODE AND
B.WWH_COMP_CODE = STC_DIM_CUSTOMER.CCO_COMP_CODE),
OM_ITEM@STCBI E
left outer join   STCBI106.STC_DIM_CATEGORY STC_DIM_CATEGORY ON
(E.ITEM_ANLY_CODE_08 = STC_DIM_CATEGORY.CATEGORY_CODE)
left outer join   STCBI106.STC_DIM_DEPARTMENT STC_DIM_DEPARTMENT ON 
(E.ITEM_ANLY_CODE_02 = STC_DIM_DEPARTMENT.DEPARTMENT_CODE AND 
E.ITEM_ANLY_CODE_06 = STC_DIM_DEPARTMENT.CLASS_CODE AND
E.ITEM_ANLY_CODE_07 = STC_DIM_DEPARTMENT.SUB_CLASS_CODE)
left outer join   STCBI106.STC_DIM_SIZE STC_DIM_SIZE ON
(E.ITEM_ANLY_CODE_12 = STC_DIM_SIZE.SIZE_CODE)
left outer join   STCBI106.STC_DIM_CAT_MANG STC_DIM_CAT_MANG ON
(E.ITEM_ANLY_CODE_13 = STC_DIM_CAT_MANG.CAT_MANG_CODE)
left outer join   STCBI106.STC_DIM_FOOD_CAT STC_DIM_FOOD_CAT ON
(E.ITEM_ANLY_CODE_03 = STC_DIM_FOOD_CAT.FOOD_CAT_CODE AND
E.ITEM_ANLY_CODE_04 = STC_DIM_FOOD_CAT.FOOD_SUB_CAT_CODE)
left outer join   STCBI106.STC_DIM_PACKING STC_DIM_PACKING ON
(E.ITEM_ANLY_CODE_11 = STC_DIM_PACKING.PACKING_CODE)
left outer join   STCBI106.STC_DIM_ARTICLE STC_DIM_ARTICLE ON 
(E.ITEM_ANLY_CODE_10 = STC_DIM_ARTICLE.ARTICLE_CODE),
OT_WMS_WAVE_ITEM@STCBI A
left outer join   STCBI106.STC_DIM_GRADE1 STC_DIM_GRADE1 on 
(A.WWI_GRADE_CODE_1 = STC_DIM_GRADE1.GRADE_CODE)
left outer join   STCBI106.STC_DIM_GRADE2 STC_DIM_GRADE2 on 
(A.WWI_GRADE_CODE_2 = STC_DIM_GRADE2.GRADE_CODE)
left outer join STCBI106.STC_DIM_ITEM STC_DIM_ITEM
on (A.WWI_ITEM_CODE = STC_DIM_ITEM.item_CODE)
left outer join STCBI106.STC_DIM_WMS_RULE STC_DIM_WMS_RULE
on (STC_DIM_WMS_RULE.WR_RULE_CODE=A.WWI_RULE_CODE)
left outer join STCBI106.STC_DIM_TXN STC_DIM_ref_TXN
on (STC_DIM_ref_TXN.TXN_CODE=A.WWI_REF_TXN_CODE)
left outer join STCBI106.STC_DIM_ITEM_UOM STC_DIM_ITEM_UOM
on (A.WWI_ITEM_CODE = STC_DIM_ITEM_UOM.iu_item_CODE AND
A.WWI_UOM_CODE = STC_DIM_ITEM_UOM.IU_UOM_CODE)
left outer join OM_ITEM_PACK@STCBI c
on (A.WWI_ITEM_CODE= c.IP_ITEM_CODE and A.WWI_UOM_CODE = c.IP_PACK_UOM_CODE)
left outer join OM_ITEM_MANF@STCBI D  
on (A.WWI_ITEM_CODE= D.IM_ITEM_CODE AND A.WWI_UOM_CODE = D.IM_MANF_PART_NO)
WHERE B.WWH_SYS_ID = A.WWI_WWH_SYS_ID AND
A.WWI_ITEM_CODE = E.ITEM_CODE AND
to_date(B.WWH_CR_DT,'DD-MM-YYYY')>=TO_DATE('1-JUL-09','DD-MM-YYYY') and
to_date(B.WWH_CR_DT,'DD-MM-YYYY')<TO_DATE('19-APR-13','DD-MM-YYYY') ;
COMMIT;