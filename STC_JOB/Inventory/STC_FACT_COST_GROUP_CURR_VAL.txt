truncate table STCBI106.STC_FACT_COST_GROUP_CURR_VAL;
commit;
insert into  STCBI106.STC_FACT_COST_GROUP_CURR_VAL
(
  GRP_COMP_ID            ,
  ITEM_UOM_ID            ,
  COMPANY_ID             ,
  COST_GROUP_ID          ,
  ITEM_ID                ,
  GRADE1_ID              ,
  GRADE2_ID              ,
  PRICE_LIST_ID          ,
  COLOR_ID               ,
  SIZE_ID                ,
  ARTICLE_ID             ,
  CAT_MANG_ID            ,
  ITEM_PACK_ID           ,
  --COUNTRY_ORIGIN_ID      ,
  CATEGORY_ID            ,
  PACKING_ID             ,
  FOOD_CAT_ID            ,
  CGCV_COMP_CODE         ,
  CGCV_COST_GROUP_CODE   ,
  CGCV_ITEM_CODE         ,
  CGCV_GRADE_CODE_1      ,
  CGCV_GRADE_CODE_2      ,
  CGCV_STK_QTY_BU        ,
  CGCV_COST_1            ,
  CGCV_VALUE_1           ,
  CGCV_COST_2            ,
  CGCV_VALUE_2           ,
  CGCV_COST_3            ,
  CGCV_VALUE_3           ,
  CGCV_CR_DT             ,
  CGCV_CR_UID            ,
  CGCV_UPD_DT            ,
  CGCV_UPD_UID           ,

  PROG_ITEM_LENGTH       ,
  PROG_ITEM_WIDTH        ,
  PROG_ITEM_AREA         ,
  PROG_ITEM_HEIGHT       ,
  IP_DIMENSION_UOM_CODE  ,
  IP_PACK_WEIGHT         ,
  IP_WEIGHT_UOM_CODE     ,
  IM_MANF_NAME           ,
  PROG_CBM               ,
  PROG_CBM_BU            ,
  PROG_CR_DT             ,
  PROG_UPD_UID           ,
  PROG_UPD_DT            ,
  PL_CODE                ,
  BRAND_ID               ,
  DEPARTMENT_ID          ,
  LOCATION_ID            ,
  TERM_ID                ,
  REASON_ID     ,
  prog_flex_vchar_01         
)

SELECT

  null
, stc_dim_item_uom.ITEM_UOM_ID
, stc_dim_companies.comp_id
, STC_DIM_LOCN_GROUP.LOCN_GROUP_ID
, stc_dim_item.item_id
, STC_DIM_GRADE1.grade1_id
, STC_DIM_GRADE2.grade2_id
, null
, NULL 
, stc_dim_size.size_id
, stc_dim_article.article_id
, stc_dim_cat_mang.cat_mang_id
, null
--, STC_DIM_COUNTRY_ORIGIN.COUNTRY_ORIGIN_ID
, STC_DIM_CATEGORY.CATEGORY_ID
, STC_DIM_PACKING.PACKING_ID
, STC_DIM_FOOD_CAT.FOOD_CAT_ID

,A.CGCV_COMP_CODE ,
A.CGCV_COST_GROUP_CODE ,
A.CGCV_ITEM_CODE ,
A.CGCV_GRADE_CODE_1 ,
A.CGCV_GRADE_CODE_2 ,
A.CGCV_STK_QTY_BU ,
A.CGCV_COST_1 ,
A.CGCV_VALUE_1 ,
A.CGCV_COST_2 ,
A.CGCV_VALUE_2 ,
A.CGCV_COST_3 ,
A.CGCV_VALUE_3 ,
A.CGCV_CR_DT ,
A.CGCV_CR_UID ,
A.CGCV_UPD_DT ,
A.CGCV_UPD_UID ,
E.IP_PACK_LENGTH ,
E.IP_PACK_WIDTH ,
(E.IP_PACK_LENGTH * E.IP_PACK_WIDTH)/10000 AS prog_ITEM_AREA ,
E.IP_PACK_HEIGHT,
E.IP_DIMENSION_UOM_CODE ,
E.IP_PACK_WEIGHT ,
E.IP_WEIGHT_UOM_CODE ,
D.IM_MANF_NAME,
(E.IP_PACK_LENGTH * E.IP_PACK_WIDTH * E.IP_PACK_HEIGHT)/1000000 AS prog_cbm ,
(E.IP_PACK_LENGTH * E.IP_PACK_WIDTH * E.IP_PACK_HEIGHT * E.IP_MAX_QTY_BU)/1000000 AS prog_cbm_BU ,
SYSDATE,
NULL,
NULL,
NULL  ,
NULL  ,
STC_DIM_DEPARTMENT.DEPARTMENT_ID  DEPARTMENT_ID ,
stc_dim_location.location_id,
NULL ,
NULL  ,
C.ITEM_UOM_CODE

from

ORION106.OS_COST_GROUP_CURR_VAL@stcbi A
--left outer join ORION106.OM_ITEM z on
--(A.CGCV_ITEM_CODE = z.item_code)

/*
left outer join ORION106.OM_ITEM_pack e 
on (A.CGCV_ITEM_CODE= e.IP_ITEM_CODE and z.item_uom_code = e.IP_pack_UOM_CODE)

LEFT OUTER JOIN STCBI106.STC_DIM_ITEM_UOM STC_DIM_ITEM_UOM ON
(Z.ITEM_UOM_CODE = STC_DIM_ITEM_UOM.IU_UOM_CODE AND
a.CGCV_ITEM_CODE = STC_DIM_ITEM_UOM.IU_ITEM_CODE)
*/
left outer join   STCBI106.STC_DIM_GRADE1 STC_DIM_GRADE1 on 
(A.CGCV_GRADE_CODE_1 = STC_DIM_GRADE1.GRADE_CODE)

left outer join   STCBI106.STC_DIM_location STC_DIM_location on 
(A.cgcv_cost_group_code = STC_DIM_location.LOCN_COSTING_GROUP)

left outer join   STCBI106.STC_DIM_GRADE2 STC_DIM_GRADE2 on 
(A.CGCV_GRADE_CODE_2 = STC_DIM_GRADE2.GRADE_CODE)

left outer join   STCBI106.STC_DIM_LOCN_GROUP STC_DIM_LOCN_GROUP ON
(A.CGCV_COST_GROUP_CODE = STC_DIM_LOCN_GROUP.LGD_CODE)

left outer join STCBI106.stc_dim_companies stc_dim_companies on 
(a.CGCV_COMP_CODE = stc_dim_companies.company_code) 

left outer join STCBI106.STC_DIM_ITEM STC_DIM_ITEM ON
(a.CGCV_ITEM_CODE = STC_DIM_ITEM.ITEM_code), 

--left outer join   STCBI106.STC_DIM_ITEM_UOM STC_DIM_ITEM_UOM ON
--(a.CGCV_ITEM_CODE = STC_DIM_ITEM_UOM.IU_ITEM_CODE),

ORION106.OM_ITEM@stcbi C

LEFT OUTER JOIN STCBI106.STC_DIM_ITEM_UOM STC_DIM_ITEM_UOM ON
(C.ITEM_UOM_CODE = STC_DIM_ITEM_UOM.IU_UOM_CODE AND
C.ITEM_CODE = STC_DIM_ITEM_UOM.IU_ITEM_CODE)

left outer join   STCBI106.STC_DIM_CATEGORY STC_DIM_CATEGORY ON
(C.ITEM_ANLY_CODE_08 = STC_DIM_CATEGORY.CATEGORY_CODE)

left outer join   STCBI106.STC_DIM_DEPARTMENT STC_DIM_DEPARTMENT ON 
(C.ITEM_ANLY_CODE_02 = STC_DIM_DEPARTMENT.DEPARTMENT_CODE AND 
 C.ITEM_ANLY_CODE_06 = STC_DIM_DEPARTMENT.CLASS_CODE AND
 C.ITEM_ANLY_CODE_07 = STC_DIM_DEPARTMENT.SUB_CLASS_CODE)

left outer join   STCBI106.STC_DIM_ARTICLE STC_DIM_ARTICLE ON 
(C.ITEM_ANLY_CODE_10 = STC_DIM_ARTICLE.ARTICLE_CODE)

left outer join   STCBI106.STC_DIM_PACKING STC_DIM_PACKING ON
(C.ITEM_ANLY_CODE_11 = STC_DIM_PACKING.PACKING_CODE)

left outer join   STCBI106.STC_DIM_SIZE STC_DIM_SIZE ON
(C.ITEM_ANLY_CODE_12 = STC_DIM_SIZE.SIZE_CODE)

left outer join   STCBI106.STC_DIM_CAT_MANG STC_DIM_CAT_MANG ON
(C.ITEM_ANLY_CODE_13 = STC_DIM_CAT_MANG.CAT_MANG_CODE)

left outer join   STCBI106.STC_DIM_FOOD_CAT STC_DIM_FOOD_CAT ON
(C.ITEM_ANLY_CODE_03 = STC_DIM_FOOD_CAT.FOOD_CAT_CODE AND
 C.ITEM_ANLY_CODE_04 = STC_DIM_FOOD_CAT.FOOD_SUB_CAT_CODE)


left outer join ORION106.OM_ITEM_MANF@STCBI D  
on (C.ITEM_CODE= D.IM_ITEM_CODE AND C.ITEM_UOM_CODE = D.IM_MANF_PART_NO)

left outer join ORION106.OM_ITEM_PACK@STCBI e 
on (C.ITEM_CODE= E.IP_ITEM_CODE and 
C.ITEM_UOM_CODE = E.IP_PACK_UOM_CODE)



where A.CGCV_ITEM_CODE = C.ITEM_CODE AND 
A.CGCV_CR_DT >=  TO_DATE('1/jul/2009', 'DD/MM/YYYY') AND 
to_date(A.CGCV_CR_DT,'DD/MM/YYYY')  < TO_DATE(SYSDATE, 'DD/MM/YYYY') ; 
--ORDER BY 1
commit;
delete from  STC_FACT_COST_GROUP_CURR_VAL WHERE CGCV_COMP_CODE IN 
('261','277','278','280','286','287','205','210','213','255','269','283');

commit;