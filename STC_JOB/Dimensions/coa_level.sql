drop table PM_PRG_6_LEVEL;
commit;
create table PM_PRG_6_LEVEL as
SELECT LVL_FORMAT_ID,
LVL_CODE,
LVL_NAME,
LVL_PARENT_CODE,
LVL_NAME LVL_PARENT_NAME,
0 LVL_PARENT_CODE1,
LVL_NAME LVL_PARENT_NAME1,
0 LVL_PARENT_CODE2,
LVL_NAME LVL_PARENT_NAME2,
0 LVL_PARENT_CODE3,
LVL_NAME LVL_PARENT_NAME3,
0 LVL_PARENT_CODE4,
LVL_NAME LVL_PARENT_NAME4,
0 LVL_PARENT_CODE5,
LVL_NAME LVL_PARENT_NAME5,
0 LVL_PARENT_CODE6,
LVL_NAME LVL_PARENT_NAME6,
0 LVL_PARENT_CODE7,
LVL_NAME LVL_PARENT_NAME7
FROM FM_COA_LEVEL;
update PM_PRG_6_LEVEL
set LVL_PARENT_NAME = null ,
LVL_PARENT_CODE1 = null,
LVL_PARENT_NAME1 = null,
LVL_PARENT_CODE2 = null,
LVL_PARENT_NAME2 = null,
LVL_PARENT_CODE3 = null,
LVL_PARENT_NAME3 = null,
LVL_PARENT_CODE4 = null,
LVL_PARENT_NAME4 = null,
LVL_PARENT_CODE5 = null,
LVL_PARENT_NAME5 = null,
LVL_PARENT_CODE6 = null,
LVL_PARENT_NAME6 = null,
LVL_PARENT_CODE7 = null,
LVL_PARENT_NAME7 = null;
COMMIT;   
update PM_PRG_6_LEVEL
set LVL_PARENT_CODE = LVL_CODE
where LVL_PARENT_CODE is null;
update PM_PRG_6_LEVEL A
set LVL_PARENT_NAME = 
(select  B.LVL_NAME  from PM_PRG_6_LEVEL  B
where A.LVL_PARENT_CODE = B.LVL_CODE
and A.LVL_FORMAT_ID = B.LVL_FORMAT_ID);
update PM_PRG_6_LEVEL A
set LVL_PARENT_CODE1 = 
(select  B.LVL_PARENT_CODE  from PM_PRG_6_LEVEL  B
where A.LVL_PARENT_CODE = B.LVL_CODE
and A.LVL_FORMAT_ID = B.LVL_FORMAT_ID);
update PM_PRG_6_LEVEL
set LVL_PARENT_CODE1 = LVL_PARENT_CODE
where LVL_PARENT_CODE1 is null;
update PM_PRG_6_LEVEL A
set LVL_PARENT_NAME1 = 
(select  B.LVL_NAME  from PM_PRG_6_LEVEL  B
where A.LVL_PARENT_CODE1 = B.LVL_CODE
and A.LVL_FORMAT_ID = B.LVL_FORMAT_ID);
update PM_PRG_6_LEVEL A
set LVL_PARENT_CODE2 = 
(select  B.LVL_PARENT_CODE  from PM_PRG_6_LEVEL  B
where A.LVL_PARENT_CODE1 = B.LVL_CODE
and A.LVL_FORMAT_ID = B.LVL_FORMAT_ID);
update PM_PRG_6_LEVEL
set LVL_PARENT_CODE2 = LVL_PARENT_CODE1
where LVL_PARENT_CODE2 is null;
update PM_PRG_6_LEVEL A
set LVL_PARENT_NAME2 = 
(select  B.LVL_NAME  from PM_PRG_6_LEVEL  B
where A.LVL_PARENT_CODE2 = B.LVL_CODE
and A.LVL_FORMAT_ID = B.LVL_FORMAT_ID);
update PM_PRG_6_LEVEL A
set LVL_PARENT_CODE3 = 
(select  B.LVL_PARENT_CODE  from PM_PRG_6_LEVEL  B
where A.LVL_PARENT_CODE2 = B.LVL_CODE
and A.LVL_FORMAT_ID = B.LVL_FORMAT_ID);
update PM_PRG_6_LEVEL
set LVL_PARENT_CODE3 = LVL_PARENT_CODE2
where LVL_PARENT_CODE3 is null;
update PM_PRG_6_LEVEL A
set LVL_PARENT_NAME3 = 
(select  B.LVL_NAME  from PM_PRG_6_LEVEL  B
where A.LVL_PARENT_CODE3 = B.LVL_CODE
and A.LVL_FORMAT_ID = B.LVL_FORMAT_ID);
update PM_PRG_6_LEVEL A
set LVL_PARENT_CODE4 = 
(select  B.LVL_PARENT_CODE  from PM_PRG_6_LEVEL  B
where A.LVL_PARENT_CODE3 = B.LVL_CODE
and A.LVL_FORMAT_ID = B.LVL_FORMAT_ID);
update PM_PRG_6_LEVEL
set LVL_PARENT_CODE4 = LVL_PARENT_CODE2
where LVL_PARENT_CODE4 is null;
update PM_PRG_6_LEVEL A
set LVL_PARENT_NAME4 = 
(select  B.LVL_NAME  from PM_PRG_6_LEVEL  B
where A.LVL_PARENT_CODE4 = B.LVL_CODE
and A.LVL_FORMAT_ID = B.LVL_FORMAT_ID);
update PM_PRG_6_LEVEL A
set LVL_PARENT_CODE5 = 
(select  B.LVL_PARENT_CODE  from PM_PRG_6_LEVEL  B
where A.LVL_PARENT_CODE4 = B.LVL_CODE
and A.LVL_FORMAT_ID = B.LVL_FORMAT_ID);
update PM_PRG_6_LEVEL
set LVL_PARENT_CODE5 = LVL_PARENT_CODE2
where LVL_PARENT_CODE5 is null;
update PM_PRG_6_LEVEL A
set LVL_PARENT_NAME5 = 
(select  B.LVL_NAME  from PM_PRG_6_LEVEL  B
where A.LVL_PARENT_CODE5 = B.LVL_CODE
and A.LVL_FORMAT_ID = B.LVL_FORMAT_ID);
update PM_PRG_6_LEVEL A
set LVL_PARENT_CODE6 = 
(select  B.LVL_PARENT_CODE  from PM_PRG_6_LEVEL  B
where A.LVL_PARENT_CODE5 = B.LVL_CODE
and A.LVL_FORMAT_ID = B.LVL_FORMAT_ID);
update PM_PRG_6_LEVEL
set LVL_PARENT_CODE6 = LVL_PARENT_CODE2
where LVL_PARENT_CODE6 is null;
update PM_PRG_6_LEVEL A
set LVL_PARENT_NAME6 = 
(select  B.LVL_NAME  from PM_PRG_6_LEVEL  B
where A.LVL_PARENT_CODE6 = B.LVL_CODE
and A.LVL_FORMAT_ID = B.LVL_FORMAT_ID);
commit;