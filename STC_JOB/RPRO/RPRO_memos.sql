TRUNCATE TABLE RPRO_FACT_INVOICES;
COMMIT;
INSERT INTO RPRO_FACT_INVOICES
(
  FLDKEY
, FLDMAIN
, FLDINVCHDRNOTES
, FLDSTORESTATN
, FLDTAX
, FLDTAXPRC
, FLDDISCPRC
, FLDDISCOUNT
, FLDSHIPPING
, FLDFEE
, FLDINVCCOMMENT1
, FLDINVCCOMMENT2
, FLDTAXAREA
, FLDSHIPPINGPRC
, FLDFEETYPE
, FLDFEETAXPRC
, FLDTAXONFEESHIP
, FLDTAXREBATEPRC
, FLDTAXREBATE
, FLDINVCROUNDAMT
, FLDINVCTOTALROUNDAMT
, FLDITEMSCOUNT
, FLDINVCTOTALOFLINEDISC
, FLDINVCHDRRCPTSTATUS
, FLDINVCHDRRCPTTYPE
, FLDCASHIER
, FLDDOCDATE
, FLDINVCNUM
, FLDCLERK
, FLDBILLTOCUSTNUMBER
, FLDBILLTOCUSTCOMPANY
, FLDBILLTOFNAME
, FLDBILLTOLNAME
, FLDBILLTOTITLE
, FLDBILLTOADDR1
, FLDBILLTOADDR2
, FLDBILLTOADDR3
, FLDBILLTOZIP
, FLDBILLTOINFO1
, FLDBILLTOINFO2
, FLDSHIPTOCUSTNUMBER
, FLDSHIPTOCUSTCOMPANY
, FLDSHIPTOFNAME
, FLDSHIPTOLNAME
, FLDSHIPTOTITLE
, FLDSHIPTOADDR1
, FLDSHIPTOADDR2
, FLDSHIPTOADDR3
, FLDSHIPTOZIP
, FLDSHIPTOINFO1
, FLDSHIPTOINFO2
, FLDBILLTOCUSTSID
, FLDSHIPTOCUSTSID
, FLDSUBTOTAL
, FLDTOTAL
, FLDBILLTOFULLNAME
, FLDSHIPTOFULLNAME
, FLDWORKSTATION
, FLDDOCTIME
, FLDBILLTOSC
, FLDBILLTOCHKS
, FLDSONUMBER
, FLDSOTYPE
, FLDBILLTOPICTURE
, FLDSHIPTOPICTURE
, FLDITEMPICTURE
, FLDFLAG1
, FLDFLAG2
, FLDFLAG3
, FLDGL
, FLDAR1
, FLDPR
, FLDINVCIDX2
, FLDINVCIDX12
, FLDBILLTOPHONE1
, FLDBILLTOPHONE2
, FLDSHIPTOPHONE1
, FLDSHIPTOPHONE2
, FLDBUSCON
, FLDSOCUSTPONUMBER
, FLDSTOREHEADING1
, FLDSTOREHEADING2
, FLDSTOREHEADING3
, FLDINVCIDX7
, FLDTENDER
, FLDINVCIDX6
, FLDSTORE
, FLDSTATION
, FLDDOCLASTEDIT
, FLDTRANSMITTED
, FLDSTYLEPICTURE
, FLDDOCPOSTDATE
, FLDTRACKINGNUM
, FLDCREDLIM
, FLDREFDOCNUM
, FLDREFDOCPOSTDT
, FLDINVCTOTALQTY
, FLDCREDUSED
, FLDTOTALFC1
, FLDSTOREHEADING4
, FLDSTOREHEADING5
, FLDSTOREHEADING6
, FLDPRCLVL
, FLDEXTORIGPRC
, FLDORIGSTORESTATN
, FLDAUDITED
, FLDTAXAREA2
, FLDTOTALTAX
, FLDTAX2
, FLDTAX2PRC
, FLDDEFSUBLOC
, FLDMOVNOTESHIPNUM
, FLDSEQWSNO
, FLDDATAORIGIN
, FLDCHARGEDUEDATE
, FLDSUBTOTALWITHOUTTAX
, FLDSHIPTOAUX12
, FLDSHIPTOAUX11
, FLDSHIPTOAUX10
, FLDSHIPTOAUX9
, FLDSHIPTOAUX8
, FLDSHIPTOAUX7
, FLDSHIPTOAUX6
, FLDSHIPTOAUX5
, FLDSHIPTOAUX4
, FLDSHIPTOAUX3
, FLDSHIPTOAUX2
, FLDSHIPTOAUX1
, FLDBILLTOAUX12
, FLDBILLTOAUX11
, FLDBILLTOAUX10
, FLDBILLTOAUX9
, FLDBILLTOAUX8
, FLDBILLTOAUX7
, FLDBILLTOAUX6
, FLDBILLTOAUX5
, FLDBILLTOAUX4
, FLDBILLTOAUX3
, FLDBILLTOAUX2
, FLDBILLTOAUX1
, FLDBILLTOUDF8
, FLDBILLTOUDF7
, FLDBILLTOUDF6
, FLDBILLTOUDF5
, FLDBILLTOUDF4
, FLDBILLTOUDF3
, FLDBILLTOUDF2
, FLDSHIPTOUDF8
, FLDSHIPTOUDF7
, FLDSHIPTOUDF6
, FLDSHIPTOUDF5
, FLDSHIPTOUDF4
, FLDSHIPTOUDF3
, FLDSHIPTOUDF2
, FLDBILLTOUDF1
, FLDSHIPTOUDF1
, FLDBILLTOEMAIL
, FLDSHIPTOEMAIL
, FLDDOCVAT
, FLDREFDOCSID
, FLDDOCSID
, FLDLOTNUM
, FLDLOTCRTDATE
, FLDLOTMODDATE
, FLDLOTEXPDATE
, FLDSTATUS
, I_FLDKEY
, I_FLDMAIN
, I_FLDFKEY
, I_FLDDCS 
, I_FLDVENDORCODE
, I_FLDDESC1
, I_FLDDESC2
, I_FLDATTR
, I_FLDSIZE
, I_FLDUPC
, I_FLDALU
, I_FLDUDF0
, I_FLDUDF1
, I_FLDUDF2
, I_FLDUDF3
, I_FLDCOMMCOD
, I_FLDSPIF
, I_FLDCOMMAMT
, I_FLDTAXCD
, I_FLDEDI
, I_FLDMGN
, I_FLDMGNPRC
, I_FLDCOEFF
, I_FLDTAXPRC
, I_FLDTAX
, I_FLDQTY
, I_FLDSTRQTY
, I_FLDMRGWTX
, I_FLDUNITSCASE
, I_FLDCASEQTY
, I_FLDNDECIMALS
, I_FLDINVCITEMPRC
, I_FLDINVCITEMPWT
, I_FLDINVCITEMCOST
, I_FLDDOCITEMDISC
, I_FLDDCSNAME
, I_FLDMKUPPRC
, I_FLDTOTONHND
, I_FLDEXTPRC
, I_FLDEXTCOST
, I_FLDEXTPWT
, I_FLDDOCITEMDISCLVL
, I_FLDCASESTRQTY
, I_FLDDOCITEMORIGPRC
, I_FLDDOCITEMORIGTAX
, I_FLDCLERK
, I_FLDITEMLOOKUP
, I_FLDPRCLVL
, I_FLDDSCSCH
, I_FLDITEMMODIFIED
, I_FLDDOCITEMORIGPWT
, I_FLDITEMSID
, I_FLDDOCITEMDISCAMT
, I_FLDRECNO
, I_FLDFC1PRC
, I_FLDFC1PRCWTX
, I_FLDSTYLESID
, I_FLDDESC3
, I_FLDDESC4
, I_FLDINVNAUX0
, I_FLDINVNAUX1
, I_FLDINVNAUX2
, I_FLDINVNAUX3
, I_FLDINVNAUX4
, I_FLDINVNAUX5
, I_FLDINVNAUX6
, I_FLDINVNAUX7
, I_FLDINVNUDFSTR
, I_FLDINVNUDFDATE
, I_FLDINVNFRSTPRC
, I_FLDINVNFRSTPWT
, I_FLDINVNSERIALFLG
, I_FLDSERIALNUM
, I_FLDCOSTCODE
, I_FLDINVCITEMCOSTCODE
, I_FLDDOCITMKITFLG
, I_FLDDOCITMPKGITMNO
, I_FLDKITCOMPONENT
, I_FLDNONINVENTORY
, I_FLDCOMMITTED
, I_FLDDOCITEMRNDDISC
, I_FLDEXTORIGPRC
, I_FLDTOTALTAX
, I_FLDTAX2PRC
, I_FLDTAX2
, I_FLDTAX2CD
, I_FLDTAX1CD
, I_FLDTAXAREA2
, I_FLDDEFSUBLOC
, I_FLDITEMSCALE
, I_FLDSEQNUM
, I_FLDEXTTAX
, I_FLDEXTTAX2
, I_FLDEXTTOTALTAX
, I_FLDDOCITMUSRDISC
, I_FLDITEMPICTURE
, I_FLDITEMDETAXFLAG
, I_FLDITEMDETAXTAXP
, I_FLDITEMDETAXTAXA
, I_FLDITEMDETAXPWT
, I_FLDLOTNUM
, I_FLDINVNLOTFLG
, I_FLDLOTCRTDATE
, I_FLDLOTMODDATE
, I_FLDLOTEXPDATE
, I_FLDSTYLEPICTURE
, I_FLDSTATUS
, PROG_CR_DT
, STORE_ID
, ITEM_ID
, DEPARTMENT_ID
, SUPPLIER_ID
, RPRO_ITEM_ID
, RPRO_VENDOR_ID
, COMPANY_ID
)
SELECT
  A.FLDKEY
, A.FLDMAIN
, A.FLDINVCHDRNOTES
, A.FLDSTORESTATN
, A.FLDTAX
, A.FLDTAXPRC
, A.FLDDISCPRC
, A.FLDDISCOUNT
, A.FLDSHIPPING
, A.FLDFEE
, A.FLDINVCCOMMENT1
, A.FLDINVCCOMMENT2
, A.FLDTAXAREA
, A.FLDSHIPPINGPRC
, A.FLDFEETYPE
, A.FLDFEETAXPRC
, A.FLDTAXONFEESHIP
, A.FLDTAXREBATEPRC
, A.FLDTAXREBATE
, A.FLDINVCROUNDAMT
, A.FLDINVCTOTALROUNDAMT
, A.FLDITEMSCOUNT
, A.FLDINVCTOTALOFLINEDISC
, A.FLDINVCHDRRCPTSTATUS
, A.FLDINVCHDRRCPTTYPE
, A.FLDCASHIER
, A.FLDDOCDATE
, A.FLDINVCNUM
, A.FLDCLERK
, A.FLDBILLTOCUSTNUMBER
, A.FLDBILLTOCUSTCOMPANY
, A.FLDBILLTOFNAME
, A.FLDBILLTOLNAME
, A.FLDBILLTOTITLE
, A.FLDBILLTOADDR1
, A.FLDBILLTOADDR2
, A.FLDBILLTOADDR3
, A.FLDBILLTOZIP
, A.FLDBILLTOINFO1
, A.FLDBILLTOINFO2
, A.FLDSHIPTOCUSTNUMBER
, A.FLDSHIPTOCUSTCOMPANY
, A.FLDSHIPTOFNAME
, A.FLDSHIPTOLNAME
, A.FLDSHIPTOTITLE
, A.FLDSHIPTOADDR1
, A.FLDSHIPTOADDR2
, A.FLDSHIPTOADDR3
, A.FLDSHIPTOZIP
, A.FLDSHIPTOINFO1
, A.FLDSHIPTOINFO2
, A.FLDBILLTOCUSTSID
, A.FLDSHIPTOCUSTSID
, A.FLDSUBTOTAL
, A.FLDTOTAL
, A.FLDBILLTOFULLNAME
, A.FLDSHIPTOFULLNAME
, A.FLDWORKSTATION
, A.FLDDOCTIME
, A.FLDBILLTOSC
, A.FLDBILLTOCHKS
, A.FLDSONUMBER
, A.FLDSOTYPE
, A.FLDBILLTOPICTURE
, A.FLDSHIPTOPICTURE
, A.FLDITEMPICTURE
, A.FLDFLAG1
, A.FLDFLAG2
, A.FLDFLAG3
, A.FLDGL
, A.FLDAR1
, A.FLDPR
, A.FLDINVCIDX2
, A.FLDINVCIDX12
, A.FLDBILLTOPHONE1
, A.FLDBILLTOPHONE2
, A.FLDSHIPTOPHONE1
, A.FLDSHIPTOPHONE2
, A.FLDBUSCON
, A.FLDSOCUSTPONUMBER
, A.FLDSTOREHEADING1
, A.FLDSTOREHEADING2
, A.FLDSTOREHEADING3
, A.FLDINVCIDX7
, A.FLDTENDER
, A.FLDINVCIDX6
, A.FLDSTORE
, A.FLDSTATION
, A.FLDDOCLASTEDIT
, A.FLDTRANSMITTED
, A.FLDSTYLEPICTURE
, A.FLDDOCPOSTDATE
, A.FLDTRACKINGNUM
, A.FLDCREDLIM
, A.FLDREFDOCNUM
, A.FLDREFDOCPOSTDT
, A.FLDINVCTOTALQTY
, A.FLDCREDUSED
, A.FLDTOTALFC1
, A.FLDSTOREHEADING4
, A.FLDSTOREHEADING5
, A.FLDSTOREHEADING6
, A.FLDPRCLVL
, A.FLDEXTORIGPRC
, A.FLDORIGSTORESTATN
, A.FLDAUDITED
, A.FLDTAXAREA2
, A.FLDTOTALTAX
, A.FLDTAX2
, A.FLDTAX2PRC
, A.FLDDEFSUBLOC
, A.FLDMOVNOTESHIPNUM
, A.FLDSEQWSNO
, A.FLDDATAORIGIN
, A.FLDCHARGEDUEDATE
, A.FLDSUBTOTALWITHOUTTAX
, A.FLDSHIPTOAUX12
, A.FLDSHIPTOAUX11
, A.FLDSHIPTOAUX10
, A.FLDSHIPTOAUX9
, A.FLDSHIPTOAUX8
, A.FLDSHIPTOAUX7
, A.FLDSHIPTOAUX6
, A.FLDSHIPTOAUX5
, A.FLDSHIPTOAUX4
, A.FLDSHIPTOAUX3
, A.FLDSHIPTOAUX2
, A.FLDSHIPTOAUX1
, A.FLDBILLTOAUX12
, A.FLDBILLTOAUX11
, A.FLDBILLTOAUX10
, A.FLDBILLTOAUX9
, A.FLDBILLTOAUX8
, A.FLDBILLTOAUX7
, A.FLDBILLTOAUX6
, A.FLDBILLTOAUX5
, A.FLDBILLTOAUX4
, A.FLDBILLTOAUX3
, A.FLDBILLTOAUX2
, A.FLDBILLTOAUX1
, A.FLDBILLTOUDF8
, A.FLDBILLTOUDF7
, A.FLDBILLTOUDF6
, A.FLDBILLTOUDF5
, A.FLDBILLTOUDF4
, A.FLDBILLTOUDF3
, A.FLDBILLTOUDF2
, A.FLDSHIPTOUDF8
, A.FLDSHIPTOUDF7
, A.FLDSHIPTOUDF6
, A.FLDSHIPTOUDF5
, A.FLDSHIPTOUDF4
, A.FLDSHIPTOUDF3
, A.FLDSHIPTOUDF2
, A.FLDBILLTOUDF1
, A.FLDSHIPTOUDF1
, A.FLDBILLTOEMAIL
, A.FLDSHIPTOEMAIL
, A.FLDDOCVAT
, A.FLDREFDOCSID
, A.FLDDOCSID
, A.FLDLOTNUM
, A.FLDLOTCRTDATE
, A.FLDLOTMODDATE
, A.FLDLOTEXPDATE
, A.FLDSTATUS
, B.FLDKEY
, B.FLDMAIN
, B.FLDFKEY
, B.FLDDCS 
, B.FLDVENDORCODE
, B.FLDDESC1
, B.FLDDESC2
, B.FLDATTR
, B.FLDSIZE
, B.FLDUPC
, B.FLDALU
, B.FLDUDF0
, B.FLDUDF1
, B.FLDUDF2
, B.FLDUDF3
, B.FLDCOMMCOD
, B.FLDSPIF
, B.FLDCOMMAMT
, B.FLDTAXCD
, B.FLDEDI
, B.FLDMGN
, B.FLDMGNPRC
, B.FLDCOEFF
, B.FLDTAXPRC
, B.FLDTAX
, B.FLDQTY
, B.FLDSTRQTY
, B.FLDMRGWTX
, B.FLDUNITSCASE
, B.FLDCASEQTY
, B.FLDNDECIMALS
, B.FLDINVCITEMPRC
, B.FLDINVCITEMPWT
, B.FLDINVCITEMCOST
, B.FLDDOCITEMDISC
, B.FLDDCSNAME
, B.FLDMKUPPRC
, B.FLDTOTONHND
, B.FLDEXTPRC
, B.FLDEXTCOST
, B.FLDEXTPWT
, B.FLDDOCITEMDISCLVL
, B.FLDCASESTRQTY
, B.FLDDOCITEMORIGPRC
, B.FLDDOCITEMORIGTAX
, B.FLDCLERK
, B.FLDITEMLOOKUP
, B.FLDPRCLVL
, B.FLDDSCSCH
, B.FLDITEMMODIFIED
, B.FLDDOCITEMORIGPWT
, B.FLDITEMSID
, B.FLDDOCITEMDISCAMT
, B.FLDRECNO
, B.FLDFC1PRC
, B.FLDFC1PRCWTX
, B.FLDSTYLESID
, B.FLDDESC3
, B.FLDDESC4
, B.FLDINVNAUX0
, B.FLDINVNAUX1
, B.FLDINVNAUX2
, B.FLDINVNAUX3
, B.FLDINVNAUX4
, B.FLDINVNAUX5
, B.FLDINVNAUX6
, B.FLDINVNAUX7
, B.FLDINVNUDFSTR
, B.FLDINVNUDFDATE
, B.FLDINVNFRSTPRC
, B.FLDINVNFRSTPWT
, B.FLDINVNSERIALFLG
, B.FLDSERIALNUM
, B.FLDCOSTCODE
, B.FLDINVCITEMCOSTCODE
, B.FLDDOCITMKITFLG
, B.FLDDOCITMPKGITMNO
, B.FLDKITCOMPONENT
, B.FLDNONINVENTORY
, B.FLDCOMMITTED
, B.FLDDOCITEMRNDDISC
, B.FLDEXTORIGPRC
, B.FLDTOTALTAX
, B.FLDTAX2PRC
, B.FLDTAX2
, B.FLDTAX2CD
, B.FLDTAX1CD
, B.FLDTAXAREA2
, B.FLDDEFSUBLOC
, B.FLDITEMSCALE
, B.FLDSEQNUM
, B.FLDEXTTAX
, B.FLDEXTTAX2
, B.FLDEXTTOTALTAX
, B.FLDDOCITMUSRDISC
, B.FLDITEMPICTURE
, B.FLDITEMDETAXFLAG
, B.FLDITEMDETAXTAXP
, B.FLDITEMDETAXTAXA
, B.FLDITEMDETAXPWT
, B.FLDLOTNUM
, B.FLDINVNLOTFLG
, B.FLDLOTCRTDATE
, B.FLDLOTMODDATE
, B.FLDLOTEXPDATE
, B.FLDSTYLEPICTURE
, B.FLDSTATUS
, sysdate
, RPRO_DIM_STORE.STORE_ID
, STC_DIM_ITEM.ITEM_ID
, STC_DIM_DEPARTMENT.DEPARTMENT_ID
, STC_DIM_SUPPLIER.SUPPLIER_ID
, RPRO_DIM_ITEM.RPRO_ITEM_ID
, RPRO_DIM_VENDOR.RPRO_VENDOR_ID
, Z.COMP_ID
FROM rpro.TBLINVOICES A
left outer join stcbi106.RPRO_DIM_STORE RPRO_DIM_STORE  --  STORE_ID 
on (A.FLDMAIN = RPRO_DIM_STORE.FLDMAIN AND 
A.FLDSTORE = RPRO_DIM_STORE.FLDSTOREID)
left outer join RPRO_MAPPING_ORION D on
(A.FLDMAIN=D.MAIN_ID and A.FLDSTORE=D.STORE_ID)
left outer join STC_DIM_COMPANIES Z on
(Z.company_code=D.company_code),
rpro.NTBLINVOICEITEMS B
left outer join stcbi106.STC_DIM_ITEM STC_DIM_ITEM  --  ITEM_ID
on (B.FLDDESC2 = STC_DIM_ITEM.ITEM_CODE)
left outer join rpro.TBLITEMS C on
(B.FLDITEMLOOKUP=C.FLDITEMNUM and b.FLDMAIN= c.FLDMAIN)
left outer join stcbi106.STC_DIM_DEPARTMENT STC_DIM_DEPARTMENT
ON (STC_DIM_DEPARTMENT.DEPARTMENT_CODE = ltrim(rtrim(C.FLDDEPT)) AND
STC_DIM_DEPARTMENT.CLASS_CODE =ltrim(rtrim(C.FLDCLASS)) AND
STC_DIM_DEPARTMENT.SUB_CLASS_CODE = ltrim(rtrim(C.FLDSUBCLASS)))  -------DEPARTMENT_ID
left outer join stcbi106.RPRO_DIM_VENDOR RPRO_DIM_VENDOR
ON (b.FLDVENDORCODE = RPRO_DIM_VENDOR.FLDVENDORCODE)
left outer join stcbi106.RPRO_DIM_ITEM RPRO_DIM_ITEM ON
(B.FLDMAIN = RPRO_DIM_ITEM.FLDMAIN AND 
B.FLDITEMLOOKUP = RPRO_DIM_ITEM.FLDITEMNUM)
left outer join stcbi106.stc_dim_supplier stc_dim_supplier ON
(stc_dim_supplier.SUPP_CODE = B.FLDVENDORCODE)
where  A.FLDKEY = B.FLDFKEY AND 
A.FLDDOCDATE < TO_DATE('01/JUN/2013', 'DD/MM/YYYY');
COMMIT;