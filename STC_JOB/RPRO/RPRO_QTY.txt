TRUNCATE TABLE  STCBI106.RPRO_FACT_ITEM_QTY;
COMMIT;
INSERT INTO  STCBI106.RPRO_FACT_ITEM_QTY
(
FLDKEY    ,
FLDFKEY    ,
FLDMAIN    ,
FLDSID    ,
FLDSTOREID,
FLDMIN    ,
FLDMAX    ,
FLDQTY    ,
FLDSTATUS,
PROG_CR_DT,--    SYSDATE

STORE_ID,    
DEPARTMENT_ID,--    DEPARTMENT_ID
ITEM_ID,--    ITEM_ID
RPRO_ITEM_ID,--    RPRO_ITEM_ID
RPRO_VENDOR_ID,--    RPRO_VENDOR_ID
SUPPLIER_ID, --    SUPPLIER_ID
COMPANY_ID--    COMP_ID
)
SELECT
  A.FLDKEY qty_fldkey
, A.FLDFKEY qty_fldfkey
, A.FLDMAIN qty_fldmain
, A.FLDSID qty_fldsid
, A.FLDSTOREID
, A.FLDMIN qty_fldmin
, A.FLDMAX qty_fldmax
, A.FLDQTY qty_fldqty
, A.FLDSTATUS qty_fldstatus
,sysdate

,RPRO_DIM_STORE.STORE_ID,    
STC_DIM_DEPARTMENT.DEPARTMENT_ID,--    DEPARTMENT_ID
STC_DIM_ITEM.ITEM_ID,--    ITEM_ID
RPRO_DIM_ITEM.RPRO_ITEM_ID,--    RPRO_ITEM_ID
RPRO_DIM_VENDOR.RPRO_VENDOR_ID,--    RPRO_VENDOR_ID
STC_DIM_SUPPLIER.SUPPLIER_ID, --    SUPPLIER_ID
STC_DIM_COMPANIES.COMP_ID

FROM RPRO.TBLQTYS A
left outer join stcbi106.STC_DIM_COMPANIES STC_DIM_COMPANIES
ON (STC_DIM_COMPANIES.COMPANY_CODE IN 
(SELECT D.COMPANY_CODE FROM RPRO_MAPPING_ORION D 
WHERE A.FLDMAIN=D.MAIN_ID and  concat('00',A.FLDSTOREID)=D.STORE_ID))


left outer join stcbi106.RPRO_DIM_STORE RPRO_DIM_STORE  --  STORE_ID 
on (A.FLDMAIN = RPRO_DIM_STORE.FLDMAIN AND concat('00',A.FLDSTOREID) = RPRO_DIM_STORE.FLDSTOREID)

left outer join stcbi106.RPRO_DIM_ITEM RPRO_DIM_ITEM-- RPRO_ITEM_ID
ON (A.FLDFKEY = RPRO_DIM_ITEM.FLDKEY AND A.FLDMAIN=RPRO_DIM_ITEM.FLDMAIN),


RPRO.TBLITEMS B

left outer join stcbi106.STC_DIM_ITEM STC_DIM_ITEM  --  ITEM_ID
on (B.FLDDESC2 = STC_DIM_ITEM.ITEM_CODE)

left outer join stcbi106.RPRO_DIM_VENDOR RPRO_DIM_VENDOR--RPRO_VENDPR_ID
on (B.FLDVENDORCODE = RPRO_DIM_VENDOR.FLDVENDORCODE)

left outer join stcbi106.STC_DIM_DEPARTMENT STC_DIM_DEPARTMENT
ON (STC_DIM_DEPARTMENT.DEPARTMENT_CODE = B.FLDDEPT AND
STC_DIM_DEPARTMENT.CLASS_CODE = B.FLDCLASS AND
STC_DIM_DEPARTMENT.SUB_CLASS_CODE = B.FLDSUBCLASS)  -------DEPARTMENT_ID

left outer join stcbi106.STC_DIM_SUPPLIER STC_DIM_SUPPLIER
ON (STC_DIM_SUPPLIER.SUPP_CODE = B.FLDVENDORCODE)--,


--RPRO.RPRO_MAPPING_ORION RPRO_MAPPING_ORION

WHERE A.FLDFKEY = B.FLDKEY;
COMMIT;